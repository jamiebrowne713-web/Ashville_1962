<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>The Hunt Begins</title>
    <meta name="description" content="A minimal, black-screen teaser with a blinking cursor, sound, and delayed typewriter reveal.">
    <style>
      :root {
        --bg: #000;
        --fg: #e5e5e5;
      }
      html, body {
        height: 100%;
      }
      body {
        margin: 0;
        background: var(--bg);
        color: var(--fg);
        font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
      }
      .screen {
        min-height: 100svh;
        display: grid;
        place-items: center;
        padding: 2rem;
      }
      .line {
        font-size: clamp(18px, 3.6vw, 36px);
        line-height: 1.4;
        letter-spacing: 0.02em;
        white-space: pre-wrap;
        max-width: 90ch;
      }
      .cursor {
        display: inline-block;
        width: 0.65ch;
        height: 1em;
        translate: 0 0.15em;
        background: var(--fg);
        margin-left: 0.15ch;
        animation: blink 1s steps(1, end) infinite;
      }
      @keyframes blink { from { opacity: 1; } to { opacity: 0; } }
      @media (prefers-reduced-motion: reduce) {
        .cursor { animation: none; }
      }
      .noise {
        position: fixed;
        inset: 0;
        pointer-events: none;
        opacity: 0.06;
        background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"><filter id="n"><feTurbulence type="fractalNoise" baseFrequency="1.2" numOctaves="2" stitchTiles="stitch"/></filter><rect width="100%" height="100%" filter="url(%23n)"/></svg>');
      }
      .riddle-container {
        margin-top: 2.5em;
        display: none;
        flex-direction: column;
        align-items: flex-start;
        gap: 2em;
        max-width: 90ch;
        width: 100%;
      }
      .riddle-block {
        margin-bottom: 1em;
      }
      .riddle-label {
        display: block;
        margin-bottom: 0.4em;
        font-size: 1em;
        opacity: 0.85;
      }
      .riddle-input {
        font-size: 1em;
        padding: 0.2em 0.5em;
        border: 1px solid #444;
        background: #111;
        color: var(--fg);
        border-radius: 3px;
        outline: none;
        transition: border-color 0.18s;
      }
      .riddle-input:focus {
        border-color: #e5e5e5;
      }
      .riddle-submit {
        margin-top: 1.2em;
        font-size: 1.1em;
        padding: 0.4em 1.2em;
        background: #222;
        color: var(--fg);
        border: 1px solid #444;
        border-radius: 3px;
        cursor: pointer;
        transition: background 0.16s, border-color 0.18s;
      }
      .riddle-submit:hover {
        background: #111;
        border-color: #e5e5e5;
      }
      .riddle-result {
        margin-top: 2em;
        font-size: 1.2em;
        color: #7fff83;
        letter-spacing: 0.04em;
      }
      .flash-congrats {
        text-align: center;
        font-size: 2.2em;
        font-weight: bold;
        color: #7fff83;
        animation: flash-congrats 0.7s linear alternate infinite;
        letter-spacing: 0.08em;
      }
      @keyframes flash-congrats {
        from { opacity: 1; }
        to { opacity: 0.2; }
      }
      .see-you-soon {
        text-align: center;
        font-size: 2em;
        font-weight: bold;
        color: #e5e5e5;
        animation: fadein 1.5s;
        letter-spacing: 0.06em;
      }
      @keyframes fadein {
        from { opacity: 0; }
        to   { opacity: 1; }
      }
    </style>
  </head>
  <body>
    <div class="screen" aria-live="polite">
      <div class="line" id="line" aria-label="typewriter">
        <span class="cursor" aria-hidden="true"></span>
      </div>
      <div class="riddle-container" id="riddle-container" aria-live="polite">
        <div class="riddle-block">
          <label class="riddle-label" for="answer1">
            I SEA YOU FROM AFAR, YOU ARE TALL AND SLENDER. I AM DRAWN TO YOU... WHO ARE YOU?
          </label>
          <input class="riddle-input" id="answer1" type="text" autocomplete="off" />
        </div>
        <div class="riddle-block">
          <label class="riddle-label" for="answer2">
            I AM HIDING IN THE MIST, IN FRONT OF YOU SEEKING YOUR GUIDANCE
          </label>
          <input class="riddle-input" id="answer2" type="text" autocomplete="off" />
        </div>
        <button class="riddle-submit" id="riddle-submit">Submit</button>
        <div class="riddle-result" id="riddle-result" style="display:none;"></div>
      </div>
    </div>
    <div class="noise" aria-hidden="true"></div>

    <!-- Audio elements -->
    <audio id="staticSound" src="https://actions.google.com/sounds/v1/ambiences/white_noise.ogg" preload="auto"></audio>
    <audio id="typeSound" src="https://actions.google.com/sounds/v1/office/typewriter.ogg" preload="auto"></audio>

    <noscript>
      <div style="position:fixed;inset:0;display:grid;place-items:center;background:#000;color:#e5e5e5;font-family:monospace;padding:2rem">
        I am watching... Don't blink
        <br>
        Maybe you're on my list?
        <br>
        I SEA YOU FROM AFAR, YOU ARE TALL AND SLENDER. I AM DRAWN TO YOU... WHO ARE YOU?
        <br>
        I AM HIDING IN THE MIST, IN FRONT OF YOU SEEKING YOUR GUIDANCE
        <br>
        (Answers: LIGHTHOUSE, BOAT)
      </div>
    </noscript>

    <script>
      (function() {
        const firstText = "I am watching... Don't blink";
        const secondText = "Maybe you're on my list?";
        const showFirstMs = 5000; // 5 seconds
        const typeIntervalMs = 75;
        const delayAfterTextMs = 1200;

        const line = document.getElementById('line');
        const staticSound = document.getElementById('staticSound');
        const typeSound = document.getElementById('typeSound');
        const riddleContainer = document.getElementById('riddle-container');

        function typeText(target, content, interval, sound) {
          return new Promise(resolve => {
            let i = 0;
            const id = setInterval(() => {
              target.textContent = content.slice(0, ++i);
              if (sound) {
                sound.currentTime = 0;
                sound.play();
              }
              if (i >= content.length) {
                clearInterval(id);
                resolve();
              }
            }, interval);
          });
        }

        // Respect reduced motion
        const reducedMotion = window.matchMedia('(prefers-reduced-motion: reduce)').matches;

        async function showTypewriterSequence() {
          staticSound.play();
          line.textContent = '';
          if (reducedMotion) {
            line.textContent = firstText;
            line.insertAdjacentHTML('beforeend', '<span class="cursor" aria-hidden="true"></span>');
            setTimeout(() => {
              line.textContent = secondText;
              line.insertAdjacentHTML('beforeend', '<span class="cursor" aria-hidden="true"></span>');
              setTimeout(() => {
                riddleContainer.style.display = 'flex';
              }, delayAfterTextMs);
            }, showFirstMs);
          } else {
            await typeText(line, firstText, typeIntervalMs, typeSound);
            line.insertAdjacentHTML('beforeend', '<span class="cursor" aria-hidden="true"></span>');
            setTimeout(async () => {
              // Replace with second text, animate
              line.textContent = '';
              await typeText(line, secondText, typeIntervalMs, typeSound);
              line.insertAdjacentHTML('beforeend', '<span class="cursor" aria-hidden="true"></span>');
              setTimeout(() => {
                riddleContainer.style.display = 'flex';
              }, delayAfterTextMs);
            }, showFirstMs);
          }
        }

        showTypewriterSequence();

        // Accessibility: allow skipping the wait with keyboard (Enter or Space)
        window.addEventListener('keydown', (e) => {
          if (e.key === 'Enter' || e.key === ' ') {
            line.textContent = secondText;
            line.insertAdjacentHTML('beforeend', '<span class="cursor" aria-hidden="true"></span>');
            riddleContainer.style.display = 'flex';
          }
        });

        // Riddle logic
        const correctAnswers = [
          "LIGHTHOUSE",
          "BOAT"
        ];

        function normalizeInput(str) {
          return (str || '').trim().replace(/\s+/g, '').toUpperCase();
        }

        const answer1 = document.getElementById('answer1');
        const answer2 = document.getElementById('answer2');
        const submitBtn = document.getElementById('riddle-submit');
        const result = document.getElementById('riddle-result');

        function handleCongratsSequence() {
          // Remove all content and show flashing "CONGRATULATIONS" in the center
          line.textContent = '';
          line.classList.remove('see-you-soon');
          line.classList.add('flash-congrats');
          line.textContent = 'CONGRATULATIONS';
          riddleContainer.style.display = 'none';

          setTimeout(() => {
            line.classList.remove('flash-congrats');
            line.classList.add('see-you-soon');
            line.textContent = 'SEE YOU SOON';
            // Close after 5 seconds
            setTimeout(() => {
              window.close();
            }, 5000);
          }, 4000);
        }

        function checkRiddle() {
          const a1 = normalizeInput(answer1.value);
          const a2 = normalizeInput(answer2.value);
          if (a1 === correctAnswers[0] && a2 === correctAnswers[1]) {
            handleCongratsSequence();
          } else {
            result.textContent = "Try again.";
            result.style.display = "block";
          }
        }

        submitBtn.addEventListener('click', checkRiddle);
        answer1.addEventListener('keydown', function(e) {
          if (e.key === 'Enter') checkRiddle();
        });
        answer2.addEventListener('keydown', function(e) {
          if (e.key === 'Enter') checkRiddle();
        });
      })();
    </script>
  </body>
</html>
